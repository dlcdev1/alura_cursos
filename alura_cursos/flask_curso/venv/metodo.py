def _updated_cost_center(last_cost_center, new_cost_center, last_tab_name, new_tab_name, sandbox_id, sheet, parameters, body_line, configuration, data):

    row_index = spreadsheet_util.get_row_index(
        sandbox_id, sheet, parameters["spreadsheet_id"], last_tab_name
    )
    row_range = f"{last_tab_name}!A{row_index}"

    if last_cost_center and last_cost_center != new_cost_center:
        body_line["values"][0][1] = new_cost_center
        buganizer = body_line["values"][0][22]
        hyperlink = f'=HYPERLINK("b/{buganizer}", "{buganizer}")'
        body_line["values"][0][22] = hyperlink if buganizer else buganizer
        processed = body_line["values"][0][21]
        body_line["values"][0][21] = True if processed else False
        _update_full_line(configuration, body_line, new_tab_name)
        data["cost_center"] = last_cost_center[0]
        # _delete(data, configuration)
        return

def _update(data, configuration):
    """Update existing row in spreadsheet."""

    sheet = spreadsheet_util.get_sheet_instance()
    parameters = configuration["parameters"]
    new_cost_center = data["cost_center"]

    tab = spreadsheet_util.get_tab_by_cost_center(data["cost_center"], sheet, parameters)
    new_tab_name = tab['name']

    body = _generate_values(data, sheet, parameters, tab)
    sandbox_id = data["sandbox_id"]

    last_cost_center, body_line, last_tab_name = spreadsheet_util.validate_last_cost_center(
        sandbox_id, sheet, parameters["spreadsheet_id"], tab["name"], new_cost_center
    )
    if last_cost_center:
        _updated_cost_center()

    row_index = spreadsheet_util.get_row_index(
        sandbox_id, sheet, parameters["spreadsheet_id"], tab["name"]
    )
    row_range = f"{tab['name']}!A{row_index}"

    spreadsheet_util.update_row(body, row_range, sheet, parameters["spreadsheet_id"])

    if __name__ == "__main__":
# updated biz services
# execute({'active': True, 'comments': '', 'correlation_id': '5768925723754496', 'created_at': '2020-10-28T13:45:59.315', 'created_by': 'davidcorreia', 'expected_service': 'navigo-simba-po-default', 'expected_service_changed_at': None, 'expected_service_changed_by': None, 'form_id': 91, 'form_team': {'description': None, 'form_id': 91, 'form_type': 'procurement_support', 'form_uuid': '7c3b3b06-d787-41b8-b2ef-25fe1baf56a4', 'id': 79, 'team': {'cost_center': None, 'cost_center_id': 65, 'description': None, 'id': 1, 'name': '362: Strategy & Operations', 'parent_id': None, 'prefix': None, 'sandbox_id_counter': None, 'type': 'team'}, 'team_id': 1}, 'form_team_id': 79, 'form_type': 'procurement_support', 'id': 76, 'navigo_id': None, 'navigo_risk': None, 'operation': 'update', 'owner': 'davidcorreia', 'permissions': {'edit': False}, 'placeholder': {'id': 76, 'sandbox_id': 'SO229', 'status_display': '-'}, 'placeholder_id': 76, 'po_number': None, 'processed': False, 'sandbox_id': '', 'sandbox_sections': [{'option': {'id': 2, 'name': 'NAVIGO, SIMBA, PO [Default]', 'question_id': 'expected_service', 'section_id': None, 'value': 'navigo-simba-po-default'}, 'path': '/expected_service', 'question_id': 'expected_service', 'value': 'navigo-simba-po-default'}], 'sections': [{'option': {'id': 3105, 'name': 'No', 'question_id': 1602, 'section_id': None, 'value': 'Value 1'}, 'path': '/1602', 'question_id': 1602, 'value': 'Value 1'}, {'option': None, 'path': '/770', 'question_id': 770, 'value': '15511'}, {'option': {'id': 1536, 'name': 'USD', 'question_id': 771, 'section_id': None, 'value': 'Value 2'}, 'path': '/771', 'question_id': 771, 'value': 'Value 2'}, {'option': None, 'path': '/902', 'question_id': 902, 'value': 'test updated '}, {'option': None, 'path': '/772', 'question_id': 772, 'value': 'test updated'}, {'option': None, 'path': '/773', 'question_id': 773, 'value': 'test updated'}, {'option': None, 'path': '/774', 'question_id': 774, 'value': 'test updated'}, {'option': None, 'path': '/775', 'question_id': 775, 'value': '2020-10-23'}, {'option': None, 'path': '/776', 'question_id': 776, 'value': '2020-10-30'}, {'option': {'id': 1539, 'name': 'No', 'question_id': 777, 'section_id': None, 'value': 'Value 2'}, 'path': '/777', 'question_id': 777, 'value': 'Value 2'}, {'option': {'id': 1809, 'name': 'No', 'question_id': 889, 'section_id': None, 'value': 'Value 2'}, 'path': '/889', 'question_id': 889, 'value': 'Value 2'}, {'option': {'id': 1811, 'name': 'No', 'question_id': 890, 'section_id': None, 'value': 'Value 2'}, 'path': '/890', 'question_id': 890, 'value': 'Value 2'}, {'option': {'id': 1813, 'name': 'No', 'question_id': 891, 'section_id': None, 'value': 'Value 2'}, 'path': '/891', 'question_id': 891, 'value': 'Value 2'}, {'option': {'id': 1815, 'name': 'No', 'question_id': 892, 'section_id': None, 'value': 'Value 2'}, 'path': '/892', 'question_id': 892, 'value': 'Value 2'}, {'option': {'id': 1937, 'name': 'Option 2', 'question_id': 778, 'section_id': None, 'value': 'Value 2'}, 'path': '/778', 'question_id': 778, 'value': 'Value 2'}, {'option': {'id': 1817, 'name': 'WIN THE C-SUITE', 'question_id': 893, 'section_id': None, 'value': 'Value 2'}, 'path': '/893', 'question_id': 893, 'value': 'Value 2'}, {'option': {'id': 1823, 'name': 'GCP', 'question_id': 894, 'section_id': None, 'value': 'Value 2'}, 'path': '/894', 'question_id': 894, 'value': 'Value 2'}, {'option': None, 'path': '/895', 'question_id': 895, 'value': 'test updated'}, {'option': None, 'path': '/896', 'question_id': 896, 'value': 'test updated'}, {'option': None, 'path': '/779', 'question_id': 779, 'value': 'test updated'}, {'option': None, 'path': '/780', 'question_id': 780, 'value': 'test updated'}, {'option': None, 'path': '/781', 'question_id': 781, 'value': 'test updated'}, {'option': None, 'path': '/782', 'question_id': 782, 'value': 'test updated'}, {'option': None, 'path': '/903', 'question_id': 903, 'value': 'test updated'}, {'option': {'id': 1834, 'name': 'Q1, Q2, Q3, Q4', 'question_id': 904, 'section_id': None, 'value': 'Value 4'}, 'path': '/904', 'question_id': 904, 'value': 'Value 4'}], 'simba_id': None, 'status_display': '_', 'team_id': 1, 'updated_at': '2020-10-28T14:31:06.199', 'updated_by': 'davidcorreia'})

# execute({'active': True, 'comments': '', 'correlation_id': '5637558813851648', 'created_at': '2020-10-28T13:28:25.458', 'created_by': 'davidcorreia', 'email': {'email_id': 'edited-business-service', 'email_task_location': 'us-central1', 'email_task_queue_name': 'sandbox-dev-tasks-send-email', 'from': 'sbox-google@ciandt.com', 'parameters': {'buganizer_id': 171869909, 'current_expected_service': 'NAVIGO, SIMBA, PO [Default]', 'date': 'Oct 28, 2020', 'email_from': 'sbox-google@ciandt.com', 'email_task_location': 'us-central1', 'email_task_queue_name': 'sandbox-dev-tasks-send-email', 'link_budget_item': 'https://budget-sandbox-dev.appspot.com/budget-items/77', 'link_buganizer': 'https://b.corp.google.com/issues/171869909', 'old_expected_service': 'Only NAVIGO & SIMBA', 'placeholder_id': 77, 'subject': 'Expected Services Updated'}, 'subject': 'Expected Services Updated', 'to': 'davidcorreia@google.com,rafaellott@google.com,rafaellott@ciandt.com'}, 'expected_service': 'navigo-simba-po-default', 'expected_service_changed_at': '2020-10-28T19:08:33.990', 'expected_service_changed_by': 'davidcorreia', 'form_id': 91, 'form_team': {'description': None, 'form_id': 91, 'form_type': 'procurement_support', 'form_uuid': '7c3b3b06-d787-41b8-b2ef-25fe1baf56a4', 'id': 79, 'team': {'cost_center': None, 'cost_center_id': 65, 'description': None, 'id': 1, 'name': '362: Strategy & Operations', 'parent_id': None, 'prefix': None, 'sandbox_id_counter': None, 'type': 'team'}, 'team_id': 1}, 'form_team_id': 79, 'form_type': 'procurement_support', 'id': 77, 'navigo_id': None, 'navigo_risk': None, 'operation': 'update', 'owner': 'davidcorreia', 'permissions': {'edit': False}, 'placeholder': {'id': 77, 'sandbox_id': 'SO230', 'status_display': '-'}, 'placeholder_id': 77, 'po_number': None, 'processed': False, 'sandbox_id': '', 'sandbox_sections': [{'option': {'id': 2, 'name': 'NAVIGO, SIMBA, PO [Default]', 'question_id': 'expected_service', 'section_id': None, 'value': 'navigo-simba-po-default'}, 'path': '/expected_service', 'question_id': 'expected_service', 'value': 'navigo-simba-po-default'}], 'sections': [{'option': {'id': 3105, 'name': 'No', 'question_id': 1602, 'section_id': None, 'value': 'Value 1'}, 'path': '/1602', 'question_id': 1602, 'value': 'Value 1'}, {'option': None, 'path': '/770', 'question_id': 770, 'value': '12'}, {'option': {'id': 1536, 'name': 'USD', 'question_id': 771, 'section_id': None, 'value': 'Value 2'}, 'path': '/771', 'question_id': 771, 'value': 'Value 2'}, {'option': None, 'path': '/902', 'question_id': 902, 'value': 'test'}, {'option': None, 'path': '/772', 'question_id': 772, 'value': 'test updated test'}, {'option': None, 'path': '/773', 'question_id': 773, 'value': 'test updated test'}, {'option': None, 'path': '/774', 'question_id': 774, 'value': 'test'}, {'option': None, 'path': '/775', 'question_id': 775, 'value': '2020-10-15'}, {'option': None, 'path': '/776', 'question_id': 776, 'value': '2020-10-29'}, {'option': {'id': 1539, 'name': 'No', 'question_id': 777, 'section_id': None, 'value': 'Value 2'}, 'path': '/777', 'question_id': 777, 'value': 'Value 2'}, {'option': {'id': 1809, 'name': 'No', 'question_id': 889, 'section_id': None, 'value': 'Value 2'}, 'path': '/889', 'question_id': 889, 'value': 'Value 2'}, {'option': {'id': 1811, 'name': 'No', 'question_id': 890, 'section_id': None, 'value': 'Value 2'}, 'path': '/890', 'question_id': 890, 'value': 'Value 2'}, {'option': {'id': 1813, 'name': 'No', 'question_id': 891, 'section_id': None, 'value': 'Value 2'}, 'path': '/891', 'question_id': 891, 'value': 'Value 2'}, {'option': {'id': 1815, 'name': 'No', 'question_id': 892, 'section_id': None, 'value': 'Value 2'}, 'path': '/892', 'question_id': 892, 'value': 'Value 2'}, {'option': {'id': 1543, 'name': 'Creative', 'question_id': 778, 'section_id': None, 'value': 'Value 1'}, 'path': '/778', 'question_id': 778, 'value': 'Value 1'}, {'option': {'id': 1817, 'name': 'WIN THE C-SUITE', 'question_id': 893, 'section_id': None, 'value': 'Value 2'}, 'path': '/893', 'question_id': 893, 'value': 'Value 2'}, {'option': {'id': 1823, 'name': 'GCP', 'question_id': 894, 'section_id': None, 'value': 'Value 2'}, 'path': '/894', 'question_id': 894, 'value': 'Value 2'}, {'option': None, 'path': '/895', 'question_id': 895, 'value': 'test'}, {'option': None, 'path': '/896', 'question_id': 896, 'value': 'test'}, {'option': None, 'path': '/779', 'question_id': 779, 'value': 'test'}, {'option': None, 'path': '/780', 'question_id': 780, 'value': 'test'}, {'option': None, 'path': '/781', 'question_id': 781, 'value': 'test'}, {'option': None, 'path': '/782', 'question_id': 782, 'value': 'test'}, {'option': None, 'path': '/903', 'question_id': 903, 'value': 'test'}, {'option': {'id': 1834, 'name': 'Q1, Q2, Q3, Q4', 'question_id': 904, 'section_id': None, 'value': 'Value 4'}, 'path': '/904', 'question_id': 904, 'value': 'Value 4'}], 'simba_id': None, 'status_display': '_', 'team_id': 1, 'updated_at': '2020-10-28T19:08:33.606', 'updated_by': 'davidcorreia'} )
# updated_cost_center
# insert do procurement support com o buganizer
# execute({'active': True, 'comments': '', 'created_at': '2020-10-28T13:28:25.458', 'created_by': 'davidcorreia', 'email': {'email_id': 'new-biz-service', 'email_task_location': 'us-central1', 'email_task_queue_name': 'sandbox-dev-tasks-send-email', 'from': 'sbox-google@ciandt.com', 'parameters': {'date': 'Oct 28, 2020', 'email_from': 'sbox-google@ciandt.com', 'email_task_location': 'us-central1', 'email_task_queue_name': 'sandbox-dev-tasks-send-email', 'link_budget_item': 'https://budget-sandbox-dev.appspot.com/budget-items/77', 'link_buganizer': 'https://b.corp.google.com/issues/{buganizer_id}', 'placeholder_id': 77, 'subject': 'New Biz Service Requested'}, 'subject': 'New Biz Service Requested', 'to': 'davidcorreia@google.com,rafaellott@google.com,rafaellott@ciandt.com'}, 'expected_service': 'navigo-simba-po-default', 'expected_service_changed_at': None, 'expected_service_changed_by': None, 'form_id': 91, 'form_team_id': 83, 'form_type': 'procurement_support', 'id': 77, 'operation': 'insert', 'owner': 'davidcorreia', 'permissions': {'edit': False}, 'placeholder': {'id': 77, 'sandbox_id': 'SO230', 'status_display': '-'}, 'processed': False, 'sandbox_id': '', 'sandbox_sections': [{'option': {'id': 2, 'name': 'NAVIGO, SIMBA, PO [Default]', 'question_id': 'expected_service', 'section_id': None, 'value': 'navigo-simba-po-default'}, 'path': '/expected_service', 'question_id': 'expected_service', 'value': 'navigo-simba-po-default'}], 'sections': [{'option': {'id': 3105, 'name': 'No', 'question_id': 1602, 'section_id': None, 'value': 'Value 1'}, 'path': '/1602', 'question_id': 1602, 'value': 'Value 1'}, {'option': None, 'path': '/770', 'question_id': 770, 'value': '12'}, {'option': {'id': 1536, 'name': 'USD', 'question_id': 771, 'section_id': None, 'value': 'Value 2'}, 'path': '/771', 'question_id': 771, 'value': 'Value 2'}, {'option': None, 'path': '/902', 'question_id': 902, 'value': 'test'}, {'option': None, 'path': '/772', 'question_id': 772, 'value': 'test'}, {'option': None, 'path': '/773', 'question_id': 773, 'value': 'test'}, {'option': None, 'path': '/774', 'question_id': 774, 'value': 'test'}, {'option': None, 'path': '/775', 'question_id': 775, 'value': '2020-10-17'}, {'option': None, 'path': '/776', 'question_id': 776, 'value': '2020-10-31'}, {'option': {'id': 1539, 'name': 'No', 'question_id': 777, 'section_id': None, 'value': 'Value 2'}, 'path': '/777', 'question_id': 777, 'value': 'Value 2'}, {'option': {'id': 1809, 'name': 'No', 'question_id': 889, 'section_id': None, 'value': 'Value 2'}, 'path': '/889', 'question_id': 889, 'value': 'Value 2'}, {'option': {'id': 1811, 'name': 'No', 'question_id': 890, 'section_id': None, 'value': 'Value 2'}, 'path': '/890', 'question_id': 890, 'value': 'Value 2'}, {'option': {'id': 1813, 'name': 'No', 'question_id': 891, 'section_id': None, 'value': 'Value 2'}, 'path': '/891', 'question_id': 891, 'value': 'Value 2'}, {'option': {'id': 1815, 'name': 'No', 'question_id': 892, 'section_id': None, 'value': 'Value 2'}, 'path': '/892', 'question_id': 892, 'value': 'Value 2'}, {'option': {'id': 1543, 'name': 'Creative', 'question_id': 778, 'section_id': None, 'value': 'Value 1'}, 'path': '/778', 'question_id': 778, 'value': 'Value 1'}, {'option': {'id': 1817, 'name': 'WIN THE C-SUITE', 'question_id': 893, 'section_id': None, 'value': 'Value 2'}, 'path': '/893', 'question_id': 893, 'value': 'Value 2'}, {'option': {'id': 1823, 'name': 'GCP', 'question_id': 894, 'section_id': None, 'value': 'Value 2'}, 'path': '/894', 'question_id': 894, 'value': 'Value 2'}, {'option': None, 'path': '/895', 'question_id': 895, 'value': 'test'}, {'option': None, 'path': '/896', 'question_id': 896, 'value': 'test'}, {'option': None, 'path': '/779', 'question_id': 779, 'value': 'test'}, {'option': None, 'path': '/780', 'question_id': 780, 'value': 'test'}, {'option': None, 'path': '/781', 'question_id': 781, 'value': 'test'}, {'option': None, 'path': '/782', 'question_id': 782, 'value': 'test'}, {'option': None, 'path': '/903', 'question_id': 903, 'value': 'test'}, {'option': {'id': 1834, 'name': 'Q1, Q2, Q3, Q4', 'question_id': 904, 'section_id': None, 'value': 'Value 4'}, 'path': '/904', 'question_id': 904, 'value': 'Value 4'}], 'status_display': '_', 'team_id': 1})
